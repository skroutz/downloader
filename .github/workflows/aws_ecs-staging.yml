#
# Deploy downloader to Staging account using the local aws_ecs Reusable workflow.
#
name: Staging deploy of Downloader to Amazon ECS on AWS Fargate

on:
  workflow_dispatch:
  push:
    branches:
      - 'staging'

jobs:
  deploy-ecs:
    uses: ./.github/workflows/aws_ecs.yml
    with:
      environment: 'staging'
      ecs_service: 'downloader-staging'
      ecs_cluster: 'downloader-staging'
      ecs_task_definition: 'aws_ecs/task_definition-staging.json'
    secrets:
      aws_gha_role_to_assume: ${{ secrets.AWS_GHA_ROLE_TO_ASSUME }}
      aws_gha_exec_role_to_assume: ${{ secrets.AWS_GHA_EXEC_ROLE_TO_ASSUME }}
